## 변경 가능한 데이터 구조를 가진 언어에서 불변성 유지하기

### 카피-온-라이트 원칙 세 단계
카피-온-라이트는 세단계로 나뉘어지며 불변성을 유지하면서 값을 변경 할 수있다.
 - 복사본 만들기
 - 복사본 변경하기
 - 복사본 리턴하기

### 쓰기를 하면서 읽기도 하는 동작은 어떻게 해야 할까요?
 - 읽기와 쓰기 함수로 각각 분리한다.
 - 함수에서 값을 두개 리턴한다.

### 쓰면서 읽기도 하는 함수를 분리하기 
 - 쓰기에서 읽기를 분리합니다.
 - 카피-온-라이트를 적용해 읽기로 바꿉니다.

### 값을 두개 리턴하는 함수로 만들기 
 - 동작을 감싸기
  - 첫번째 단계는 메서드를 바꿀 수 있도록 새로운 함수로 감싸는 것입니다.
 - 읽으면서 쓰기도 하는 함수를 읽기 함수로 바꾸기

### 불변 데이터 구조를 읽는 것을 계산입니다.
 - 변경 가능한 데이터를 읽는 것은 액션입니다.
  - 변경 가능한 값을 읽을 때 마다 다른 값을 읽을 수도 있습니다. 따라서 변경 가능한 데이터를 읽는 것은 액션입니다.
 - 쓰기는 데이터를 변경 가능한 구조로 만듭니다.
 - 어떤 데이터에 쓰기가 없다면 데이터는 변경 불가능한 데이터 입니다.
 - 불변 데이터 구조를 읽는 것은 계산입니디ㅏ.
 - 쓰기를 읽기로 바꾸면 코드에 계산이 많아집니다.

### 불변 데이터 구조는 충분히 빠릅니다.
 - 일반적으로 불변 데이터 구조는 변경 가능한 데이터 구조보다 메모리를 더 많이 쓰고 느립니다.
 - 하지만 불변 데이터 구조를 사용하면서 대용량의 고성능 시스템을 구현하는 사례는 많아졌다.
   - 언제든 최적화 할 수 있습니다.
   - 가비지 콜렉터는 매우 빠릅니다.
   - 생각보다 많이 복사하지 않습니다
   - 함수형 프로그래밍 언어네는 빠른 구현체가 있습니다.
  

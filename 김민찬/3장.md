# 액션과 계산 데이터의 차이를 알기

- 참조 투명
  - 계산은 계산을 호출하는 코드를 계산 결과로 바꿀수 있기 때문에 **참조 투명**하다.
  - 예시) 2 + 3의 결과는 항상 5이기 때문에 2 + 3이란 코드를 5라는 결과값으로 바꿔도 프로그램이 달라지지 않는다.

<br />

- 액션에서 계산과 데이터 분리하기
  - 현실 세계에서 '필요한 것 구입하기'는 액션이다.
  - 하지만 이 행위를 몇 단계로 나누면 계산과 데이터도 포함하고 있다.
  - 계산
    - 필요한 재고 - 현재 재고 = 장보기 목록
  - 데이터
    - 현재 재고 데이터

## 액션을 쪼개기에서 배운 것

1. 액션과 계산, 데이터는 어디에나 적용할 수 있다.
2. 액션 안에는 계산과 데이터, 또 다른 액션이 숨어 있을지도 모른다.
3. 계산은 더 작은 계산과 데이터로 나누고 연결할 수 있다.
4. 데이터는 데이터만 조합할 수 있다.
5. 계산은 때로 '우리 머리속에서' 일어난다. - 결정과 계획은 계산이 될 가능성이 매우 높다.

## 쿠폰 보내는 과정을 그려보기

#### 1. 데이터베이스에서 구독자를 가져오기

- 데이터베이스에서 구독자를 가져오는 단계는 **액션**이다.
  - 구독자는 계속 바뀌기 때문에 실행 시점에 의존한다.
- 데이터 베이스에서 가져온 사용자 목록은 **데이터** 이다.

#### 2. 데이터베이스에서 쿠폰 목록 가져오기

- 데이터베이스에서 쿠폰 목록을 가져오는 것도 **액션**이다.
  - 쿠폰 데이터베이스는 계속 바뀌기 떄문에 가져오는 시점이 중요하다.
- 가져온 쿠폰 목록은 **데이터**이다.
- 쿠폰 목록 데이터는 DB 쿼리 이벤트에 대한 사실이라고 할 수 있다.

#### 3. 보내야 할 이메일 목록 만들기

- 이메일 목록 계획 하기는 **계산**이다.
- 그 결과로 이메일 목록 이라는 **데이터**가 만들어진다.

#### 4. 이메일 전송하기

- 이메일 목록을 순회하면서 보낸다. 이는 **액션**이다.

#### 일반적인 구현 순서

1. 데이터
2. 계산
3. 액션

## 액션은 코드 전체로 퍼진다.

- 액션을 부르는 함수가 있다면 그 함수도 액션이 된다.
  - 이를 반복하다보면 액션이 코드 전체로 퍼진다.

## 액션의 다양한 형태

- 함수 호출
  - `alert("Heool world!");`
    - 팝업 창이 뜨는 것은 액션이다.
- 메서드 호출
  - `console.log("hello");`
    - 콘솔에 출력된다.
- 생성자
  - `new Date()`
    - 기본적으로 부르는 시점에 현재 날짜와 시간을 초기화하기 때문에 호출하는 시점에 따라 다른 값을 가진다.
- 표현식
  - 변수참조
    - `y` - y가 공유되고 변경 가능한 변수라면 읽는 시점에 따라 값이 다를 수 있다.
  - 속성 참조
    - `user.first_name` - user가 공유되고 변경 가능한 객체라면 first_name은 읽는 시점에 따라 다를 수 있다.
  - 배열 참조
    - `stack[0]` - stack이 공유되고 변경 가능한 배열이라면 첫 번째 항목은 읽는 시점에 따라 값이 다를 수 있다.
- 상태
  - 값 할당
    - `z = 3;` - 공유하기 위해 값을 할당했고 변경 가능한 변수라면 다른 코드에 영향을 주기 때문에 액션이다.
  - 속성 삭제
    - `delete user.first_name;` - 속성을 지우는 것은 다른 코드에 영향을 주기 때문에 액션이다.

---

> 자세히 알아보기

## 데이터에 대해 자세히 알아보기

- 데이터란
  - 데이터는 이벤트에 대한 사실이다. 일어난 일의 결과를 기록한 것이다.
- 불변성
  - 함수형 프로그래머는 불변 데이터 구조를 만들기 위해 두 가지 원칙을 사용한다.
    - 카피-온-라이트(copy-on-write) : 변경할 때 복사본을 만든다.
    - 방어적 복사(defensive copy) : 보관하려고 하는 데이터의 복사본을 만든다.

## 계산에 대해 자세히 알아보기

- 계산이란
  - 입력값으로 출력값을 만드는 과정. 실행 시점과 횟수에 관계없이 항상 같은 입력값에 대해 같은 출력값을 돌려준다.
- 계산은 어떻게 구현할까?
  - 계산은 함수로 구현한다.
- 액션보다 계산이 좋은 이유
  - 테스트하기 쉽다.
    - 계산은 어디서나(로컬 장비, 빌드 서버, 테스트 장비) 원하는 만큼 테스트를 실행할 수 있다.
  - 기계적인 분석이 쉽다.
    - 정적 분석에서 자동화된 분석이 가능하다.
  - 조합하기 좋다.
    - 조합해 더 큰 계산을 만들 수 있다.
- 계산을 쓰면서 걱정하지 않아도 되는 것
  - 동시에 실행되는 것
  - 과거에 실행되었던 것이나 미래에 실행할 것
  - 실행 횟수

## 액션에 대해 자세히 알아보기

- 액션이란
  - 액션은 외부 세계에 영향을 주거나 받는 것을 말한다.
  - 액션은 실행 시점과 횟수에 의존한다.
    - 언제 실행되는지 - **순서**
    - 얼마나 실행되는지 - **반복**
- 액션은 어떻게 구현할까?
  - 자바스크립트에서 함수로 구현된다.
- 액션의 예
  - 이메일 보내기
  - 계좌에서 인출하기
  - 전역변숫값 바꾸기
  - ajax 요청 보내기
- 액션을 다루는 법
  - 가능한 액션을 적게 사용한다.
    - 액션 대신 계산을 사용할 수 있는지 생각해 봐야 한다.
  - 액션은 가능한 작게 만든다.
    - 액션에서 액션과 관련 없는 코드는 모두 제거한다.
    - 액션에서 결정이나 계획과 관련된 부분은 계산으로 빼낼 수 있다.
  - 액션이 외부 세계와 상호작용하는 것을 제한할 수 있다.
    - 내부에서 계산과 데이터만 있고 가장 바깥쪽에 액션이 있는 구조가 이상적이다.
  - 액션이 호출 시점에 의존하는 것을 제한한다.
    - 액션이 호출 시점과 횟수에 덜 의존하도록 만든다.
    - 그러면 액션을 사용할 때 조금 더 쉽게 사용할 수 있다.
